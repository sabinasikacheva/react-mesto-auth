{"ast":null,"code":"import _toConsumableArray from\"/Users/admin/Documents/Sabina/mesto-react/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _slicedToArray from\"/Users/admin/Documents/Sabina/mesto-react/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React from\"react\";import Header from\"./Header.js\";import Main from\"./Main.js\";import Footer from\"./Footer.js\";import PopupWithForm from\"./PopupWithForm.js\";import ImagePopup from\"./ImagePopup.js\";import EditProfilePopup from\"./EditProfilePopup\";import EditAvatarPopup from\"./EditAvatarPopup\";import AddPlacePopup from\"./AddPlacePopup\";import api from\"../utils/Api.js\";import CurrentUserContext from\"../contexts/CurrentUserContext.js\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function App(){var _React$useState=React.useState(false),_React$useState2=_slicedToArray(_React$useState,2),isEditAvatarPopupOpen=_React$useState2[0],setIsEditAvatarPopupOpen=_React$useState2[1];var _React$useState3=React.useState(false),_React$useState4=_slicedToArray(_React$useState3,2),isEditProfilePopupOpen=_React$useState4[0],setIsEditProfilePopupOpen=_React$useState4[1];var _React$useState5=React.useState(false),_React$useState6=_slicedToArray(_React$useState5,2),isAddPlacePopupOpen=_React$useState6[0],setIsAddPlacePopupOpen=_React$useState6[1];var _React$useState7=React.useState(null),_React$useState8=_slicedToArray(_React$useState7,2),selectedCard=_React$useState8[0],setSelectedCard=_React$useState8[1];var _React$useState9=React.useState({}),_React$useState10=_slicedToArray(_React$useState9,2),currentUser=_React$useState10[0],setCurrentUser=_React$useState10[1];var _React$useState11=React.useState([]),_React$useState12=_slicedToArray(_React$useState11,2),cards=_React$useState12[0],setCards=_React$useState12[1];React.useEffect(function(){api.getCurrentUser().then(function(data){setCurrentUser(data);}).catch(function(err){console.log(err);});api.getInitialCards().then(function(cards){setCards(cards);}).catch(function(err){console.log(err);});},[]);function handleEditProfileClick(){setIsEditProfilePopupOpen(true);}function handleAddPlaceClick(){setIsAddPlacePopupOpen(true);}function handleEditAvatarClick(){setIsEditAvatarPopupOpen(true);}function handleCardClick(card){setSelectedCard(card);}function handleCardLike(card){// Снова проверяем, есть ли уже лайк на этой карточке\nvar isLiked=card.likes.some(function(i){return i._id===currentUser._id;});// Отправляем запрос в API и получаем обновлённые данные карточки\napi.changeLikeCardStatus(card._id,!isLiked).then(function(newCard){setCards(function(cards){return cards.map(function(c){return c._id===card._id?newCard:c;});});}).catch(function(err){console.log(err);});}function handleCardDelete(card){api.deleteCard(card._id).then(function(){setCards(function(cards){return cards.filter(function(c){return c._id!==card._id;});});}).catch(function(err){console.log(err);});}function closeAllPopups(){setIsEditProfilePopupOpen(false);setIsAddPlacePopupOpen(false);setIsEditAvatarPopupOpen(false);setSelectedCard(null);}function handleUpdateUser(item){api.setUserInfo(item).then(function(res){setCurrentUser(res);closeAllPopups();}).catch(function(err){return console.log(err);});}function handleUpdateAvatar(data){api.changeUserAvatar(data).then(function(res){setCurrentUser(res);closeAllPopups();}).catch(function(err){return console.log(err);});}function handleAddPlaceSubmit(item){api.createCard(item).then(function(res){setCards([res].concat(_toConsumableArray(cards)));closeAllPopups();}).catch(function(err){return console.log(err);});}return/*#__PURE__*/_jsx(CurrentUserContext.Provider,{value:currentUser,children:/*#__PURE__*/_jsxs(\"div\",{className:\"body\",children:[/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(Header,{})}),/*#__PURE__*/_jsx(Main,{onEditProfile:handleEditProfileClick,onAddPlace:handleAddPlaceClick,onEditAvatar:handleEditAvatarClick,onCardClick:handleCardClick,cards:cards,onCardLike:handleCardLike,onCardDelete:handleCardDelete}),/*#__PURE__*/_jsx(Footer,{}),/*#__PURE__*/_jsx(EditProfilePopup,{isOpen:isEditProfilePopupOpen,onClose:closeAllPopups,onUpdateUser:handleUpdateUser}),/*#__PURE__*/_jsx(AddPlacePopup,{isOpen:isAddPlacePopupOpen,onClose:closeAllPopups,onAddPlace:handleAddPlaceSubmit}),/*#__PURE__*/_jsx(EditAvatarPopup,{isOpen:isEditAvatarPopupOpen,onClose:closeAllPopups,onUpdateAvatar:handleUpdateAvatar}),/*#__PURE__*/_jsx(PopupWithForm,{name:\"delete\",title:\"\\u0412\\u044B \\u0443\\u0432\\u0435\\u0440\\u0435\\u043D\\u044B?\",buttonText:\"\\u0414\\u0430\",onClose:closeAllPopups}),/*#__PURE__*/_jsx(ImagePopup,{card:selectedCard,onClose:closeAllPopups})]})});}export default App;","map":{"version":3,"names":["React","Header","Main","Footer","PopupWithForm","ImagePopup","EditProfilePopup","EditAvatarPopup","AddPlacePopup","api","CurrentUserContext","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","App","_React$useState","useState","_React$useState2","_slicedToArray","isEditAvatarPopupOpen","setIsEditAvatarPopupOpen","_React$useState3","_React$useState4","isEditProfilePopupOpen","setIsEditProfilePopupOpen","_React$useState5","_React$useState6","isAddPlacePopupOpen","setIsAddPlacePopupOpen","_React$useState7","_React$useState8","selectedCard","setSelectedCard","_React$useState9","_React$useState10","currentUser","setCurrentUser","_React$useState11","_React$useState12","cards","setCards","useEffect","getCurrentUser","then","data","catch","err","console","log","getInitialCards","handleEditProfileClick","handleAddPlaceClick","handleEditAvatarClick","handleCardClick","card","handleCardLike","isLiked","likes","some","i","_id","changeLikeCardStatus","newCard","map","c","handleCardDelete","deleteCard","filter","closeAllPopups","handleUpdateUser","item","setUserInfo","res","handleUpdateAvatar","changeUserAvatar","handleAddPlaceSubmit","createCard","concat","_toConsumableArray","Provider","value","children","className","onEditProfile","onAddPlace","onEditAvatar","onCardClick","onCardLike","onCardDelete","isOpen","onClose","onUpdateUser","onUpdateAvatar","name","title","buttonText"],"sources":["/Users/admin/Documents/Sabina/mesto-react/src/components/App.js"],"sourcesContent":["import React from \"react\";\nimport Header from \"./Header.js\";\nimport Main from \"./Main.js\";\nimport Footer from \"./Footer.js\";\nimport PopupWithForm from \"./PopupWithForm.js\";\nimport ImagePopup from \"./ImagePopup.js\";\nimport EditProfilePopup from \"./EditProfilePopup\";\nimport EditAvatarPopup from \"./EditAvatarPopup\";\nimport AddPlacePopup from \"./AddPlacePopup\";\nimport api from \"../utils/Api.js\";\nimport CurrentUserContext from \"../contexts/CurrentUserContext.js\";\n\nfunction App() {\n  const [isEditAvatarPopupOpen, setIsEditAvatarPopupOpen] = React.useState(false);\n  const [isEditProfilePopupOpen, setIsEditProfilePopupOpen] = React.useState(false);\n  const [isAddPlacePopupOpen, setIsAddPlacePopupOpen] = React.useState(false);\n  const [selectedCard, setSelectedCard] = React.useState(null);\n  const [currentUser, setCurrentUser] = React.useState({});\n  const [cards, setCards] = React.useState([]);\n\n  React.useEffect(() => {\n    api\n      .getCurrentUser()\n      .then((data) => {\n        setCurrentUser(data);\n      })\n      .catch((err) => {\n        console.log(err);\n      });\n    api  \n      .getInitialCards()\n      .then((cards) => {\n        setCards(cards);\n       })\n      .catch((err) => {\n         console.log(err);\n     });\n  }, []);\n\n  function handleEditProfileClick() {\n    setIsEditProfilePopupOpen(true);\n  }\n\n  function handleAddPlaceClick() {\n    setIsAddPlacePopupOpen(true);\n  }\n\n  function handleEditAvatarClick() {\n    setIsEditAvatarPopupOpen(true);\n  }\n\n  function handleCardClick(card) {\n    setSelectedCard(card);\n  }\n\n  function handleCardLike(card) {\n    // Снова проверяем, есть ли уже лайк на этой карточке\n    const isLiked = card.likes.some(i => i._id === currentUser._id);\n    \n    // Отправляем запрос в API и получаем обновлённые данные карточки\n    api\n      .changeLikeCardStatus(card._id, !isLiked)\n      .then((newCard) => {\n        setCards((cards) => \n          cards.map((c) => c._id === card._id ? newCard : c));\n        })\n        .catch((err) => {\n          console.log(err);\n        });\n  }\n  function handleCardDelete(card) {\n    api.deleteCard(card._id).then(() => {\n      setCards((cards) => cards.filter((c) => c._id !== card._id));\n    })\n      .catch((err) => {\n        console.log(err);\n      });\n  }\n\n  function closeAllPopups() {\n    setIsEditProfilePopupOpen(false);\n    setIsAddPlacePopupOpen(false);\n    setIsEditAvatarPopupOpen(false);\n    setSelectedCard(null);\n  }\n\n  function handleUpdateUser(item) {\n    api\n      .setUserInfo(item)\n      .then((res) => {\n        setCurrentUser(res);\n        closeAllPopups();\n      })\n      .catch((err) => console.log(err));\n  }\n\n  function handleUpdateAvatar(data) {\n    api\n      .changeUserAvatar(data)\n      .then((res) => {\n        setCurrentUser(res);\n        closeAllPopups();\n      })\n      .catch((err) => console.log(err));\n  }\n\n  function handleAddPlaceSubmit(item) {\n    api\n      .createCard(item)\n      .then((res) => {\n        setCards([res, ...cards]);\n        closeAllPopups();\n      })\n      .catch((err) => console.log(err));\n  }\n\n  return (\n  <CurrentUserContext.Provider value={currentUser}>\n    <div className=\"body\">\n      <>\n      <Header />\n      </>\n      <Main\n        onEditProfile={handleEditProfileClick}\n        onAddPlace={handleAddPlaceClick}\n        onEditAvatar={handleEditAvatarClick}\n        onCardClick={handleCardClick}\n        cards={cards}\n        onCardLike={handleCardLike}\n        onCardDelete={handleCardDelete}\n      />\n\n      <Footer />\n      <EditProfilePopup \n        isOpen={isEditProfilePopupOpen} \n        onClose={closeAllPopups}\n        onUpdateUser={handleUpdateUser} />\n      <AddPlacePopup\n        isOpen={isAddPlacePopupOpen}\n        onClose={closeAllPopups}\n        onAddPlace={handleAddPlaceSubmit} />\n      <EditAvatarPopup\n        isOpen={isEditAvatarPopupOpen}\n        onClose={closeAllPopups}\n        onUpdateAvatar={handleUpdateAvatar} />\n      <PopupWithForm\n        name=\"delete\"\n        title=\"Вы уверены?\"\n        buttonText=\"Да\"\n        onClose={closeAllPopups}\n      ></PopupWithForm>\n      <ImagePopup\n        card={selectedCard}\n        onClose={closeAllPopups}\n      />\n    </div>\n  </CurrentUserContext.Provider>\n  );\n}\n\nexport default App;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}